
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../pg_local_installation/">
      
      
        <link rel="next" href="../pg_extensions/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.3">
    
    
      
        <title>3.0 AIGraph4pg - Quick Start Documentation - AIGraph4pg</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.d7758b05.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#30-aigraph4pg-quick-start-documentation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="AIGraph4pg" class="md-header__button md-logo" aria-label="AIGraph4pg" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            AIGraph4pg
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              3.0 AIGraph4pg - Quick Start Documentation
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/cjoakim/AIGraph4pg" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="AIGraph4pg" class="md-nav__button md-logo" aria-label="AIGraph4pg" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    AIGraph4pg
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/cjoakim/AIGraph4pg" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    1.0 Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Setup
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Setup
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pg_local_installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    2.0 AIGraph4pg : Local PostgreSQL Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    3.0 AIGraph4pg - Quick Start Documentation
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    3.0 AIGraph4pg - Quick Start Documentation
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#31-recommended-skills" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 Recommended Skills
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#32-workstation-requirements" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 Workstation Requirements
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#33-azure-paas-services-to-deploy" class="md-nav__link">
    <span class="md-ellipsis">
      3.3 Azure PaaS Services to Deploy
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.3 Azure PaaS Services to Deploy">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#331-azure-postgresql" class="md-nav__link">
    <span class="md-ellipsis">
      3.3.1 Azure PostgreSQL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#332-azure-openai" class="md-nav__link">
    <span class="md-ellipsis">
      3.3.2 Azure OpenAI
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#34-a-note-on-windows-powershell-and-macos-bash-terminal" class="md-nav__link">
    <span class="md-ellipsis">
      3.4 A Note on Windows PowerShell and macOS bash Terminal
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#35-set-the-environment-variables-for-this-project" class="md-nav__link">
    <span class="md-ellipsis">
      3.5 Set the Environment Variables for this project
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.5 Set the Environment Variables for this project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#351-list-of-enviroment-variables" class="md-nav__link">
    <span class="md-ellipsis">
      3.5.1 List of enviroment variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#352-setting-these-environment-variables" class="md-nav__link">
    <span class="md-ellipsis">
      3.5.2 Setting these Environment Variables
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#353-python-dotenv" class="md-nav__link">
    <span class="md-ellipsis">
      3.5.3 python-dotenv
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#36-clone-the-github-repo-and-create-the-python-virtual-environment" class="md-nav__link">
    <span class="md-ellipsis">
      3.6 Clone the GitHub repo and create the Python Virtual Environment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.6 Clone the GitHub repo and create the Python Virtual Environment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#361-clone-the-repo" class="md-nav__link">
    <span class="md-ellipsis">
      3.6.1 Clone the Repo
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#362-create-the-python-virtual-environment" class="md-nav__link">
    <span class="md-ellipsis">
      3.6.2 Create the Python Virtual Environment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#363-activate-the-python-virtual-environment-venv" class="md-nav__link">
    <span class="md-ellipsis">
      3.6.3 Activate the Python Virtual Environment (venv)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#364-windows-11-powershell" class="md-nav__link">
    <span class="md-ellipsis">
      3.6.4 Windows 11 PowerShell
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#365-macos-bash-shell" class="md-nav__link">
    <span class="md-ellipsis">
      3.6.5 macOS bash shell
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#37-prepare-your-azure-postgresql-server" class="md-nav__link">
    <span class="md-ellipsis">
      3.7 Prepare your Azure PostgreSQL Server
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#371-configure-the-dev-database" class="md-nav__link">
    <span class="md-ellipsis">
      3.7.1 Configure the dev database
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#372-configure-the-dev-database-for-apache-age-graphs" class="md-nav__link">
    <span class="md-ellipsis">
      3.7.2 Configure the dev database for Apache AGE graphs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#38-load-azure-postgresql-with-the-python-libraries-dataset" class="md-nav__link">
    <span class="md-ellipsis">
      3.8 Load Azure PostgreSQL with the Python Libraries Dataset
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.8 Load Azure PostgreSQL with the Python Libraries Dataset">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#381-mainpy" class="md-nav__link">
    <span class="md-ellipsis">
      3.8.1 main.py
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#382-mainpy-delete_define_libraries_table" class="md-nav__link">
    <span class="md-ellipsis">
      3.8.2 main.py - delete_define_libraries_table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#383-psql-copy-into-the-legal_cases-table" class="md-nav__link">
    <span class="md-ellipsis">
      3.8.3 psql copy into the legal_cases table
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#385-load-the-legal_cases-age-graph" class="md-nav__link">
    <span class="md-ellipsis">
      3.8.5 Load the legal_cases AGE graph
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#39-run-the-web-application-on-your-computer" class="md-nav__link">
    <span class="md-ellipsis">
      3.9 Run the Web Application on your computer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3.9 Run the Web Application on your computer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#391-run-as-a-python-process" class="md-nav__link">
    <span class="md-ellipsis">
      3.9.1 Run as a Python process
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#392-run-as-a-docker-container" class="md-nav__link">
    <span class="md-ellipsis">
      3.9.2 Run as a Docker container
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../pg_extensions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4.0 AIGraph4pg - Configuring and Using PostgreSQL Extensions
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Tutorial
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial_architecture/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorial architecture
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial_pg_admin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorial pg admin
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial_relational/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorial relational
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial_graph/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorial graph
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial_vector_search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorial vector search
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial_opencypher_gen/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tutorial opencypher gen
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../psql_commands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AIGraph4pg : Common psql Commands
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AIGraph4pg - Frequently Asked Questions (FAQ)
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="30-aigraph4pg-quick-start-documentation">3.0 AIGraph4pg - Quick Start Documentation</h1>
<p>These instructions are intended to help you deploy Azure PaaS Services
and run this reference application on your workstation.</p>
<h2 id="31-recommended-skills">3.1 Recommended Skills</h2>
<ul>
<li>Some programming language experience, especially with Python 3</li>
<li>Some understanding of Python virtual environments</li>
<li>Some understanding of Environment Variables</li>
<li>Some command-line experience, Windows PowerShell or linux/macOS bash shell</li>
</ul>
<p>There will be several steps to execute in this Quick Start,
<strong>it is not a "one-click" deploy</strong>.</p>
<hr />
<h2 id="32-workstation-requirements">3.2 Workstation Requirements</h2>
<ul>
<li><strong>Windows 11</strong> or recent <strong>Linux</strong> or <strong>macOS</strong> desktop operating system</li>
<li>The <strong>git</strong> source-control system. See https://git-scm.com/</li>
<li>The <strong>Azure CLI</strong> (i.e. - az).  See https://learn.microsoft.com/en-us/cli/azure/</li>
<li>An <strong>Azure Subscription</strong></li>
<li><strong>Standard Python 3.12.x</strong>; not Conda or other distributions.  See https://www.python.org/downloads/</li>
<li><strong>Visual Studio Code (VSC)</strong> or similar IDE/editor.  See https://code.visualstudio.com/</li>
<li><strong>A PostgreSQL client program, such as psql</strong>.  See https://www.postgresql.org/docs/current/app-psql.html</li>
<li><strong>A local/desktop PostgreSQL database installation</strong>.  This is optional, but useful for learning the basics of PostgreSQL</li>
<li><strong>Docker Desktop</strong>.  Optional, used only for executing the public DockerHub image.</li>
</ul>
<hr />
<h2 id="33-azure-paas-services-to-deploy">3.3 Azure PaaS Services to Deploy</h2>
<h3 id="331-azure-postgresql">3.3.1 Azure PostgreSQL</h3>
<ul>
<li>See the <strong>az/</strong> directory in this repo</li>
<li>Copy file <strong>az/provision-config-example.json</strong> to <strong>az/provision-config.json</strong></li>
<li>Edit the <strong>az/provision-config.json</strong> per your subscription.  The entry names are self-explanatory</li>
<li>Execute <strong>az login</strong>.  See https://learn.microsoft.com/en-us/cli/azure/authenticate-azure-cli</li>
<li>Execute the <strong>az/provision.ps1</strong> script to provision your Azure PostgreSQL server</li>
<li>Alternatively, provision this manually in Azure Portal.</li>
<li>Enable the VECTOR and AGE extensions.
See https://learn.microsoft.com/en-us/azure/postgresql/flexible-server/concepts-extensions</li>
</ul>
<p>This reference application assumes that the name of your database is <strong>dev</strong>.</p>
<h3 id="332-azure-openai">3.3.2 Azure OpenAI</h3>
<ul>
<li>Recommended, for this project, to provision this manually in Azure Portal</li>
<li>Create a <strong>text-embedding-ada-002</strong> model deployment, for embeddings and vector search</li>
<li>Create a <strong>gpt-4o</strong> model deployment, for generative AI of openCypher queries</li>
</ul>
<hr />
<h2 id="34-a-note-on-windows-powershell-and-macos-bash-terminal">3.4 A Note on Windows PowerShell and macOS bash Terminal</h2>
<p>The remaining instructions on this page describe how you should
execute <strong>command-line</strong> commands in either Windows PowerShell
or the macOS Terminal program with the bash shell.  These instructions
are primarily Windows-based, but macOS is supported, too.</p>
<p>In the remaining documentation on this page, the relative directory
location is shown for your reference.  For example, in Windows PowerShell, 
when you are in the <strong>root directory</strong> of the GitHub project you'll
see instructions like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>AIGraph4pg&gt; some command in the root directory
</code></pre></div>
<p>Likewise, when you're in the <strong>python directory</strong> beneath the AIGraph4pg 
directory, the instructions will look like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>python&gt; some command in the python directory
</code></pre></div>
<p>The project directory structure looks like this:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>Directory/File                       Description
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>├── az                           &lt;-- az CLI deployment script for Azure PostgresSQL
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>├── data
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>│   ├── countries                &lt;-- small dataset for script agefreighter_example.py
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>│   └── legal_cases              &lt;-- the relational curated dataset for this repo, zipped
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>│       ├── graph_csv            &lt;-- the graph curated dataset, csv files
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>├── docs                         &lt;-- documentation in markdown format
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>├── jupyter                      &lt;-- sample Jypyter notebook for AGE and the agefreighter library
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>├── pg_scripts                   &lt;-- scripts for using PostgreSQL CLI programs, like pg_dump
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>└── python                       &lt;-- the python3 implementation code for this project
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>    ├── agefreighter_example.py  &lt;-- simple python program to load an AGE graph with agefreighter
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>    ├── docker-compose.yml       &lt;-- yaml file used to run the web app with docker compose
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>    ├── Dockerfile               &lt;-- file used to create the Docker image
<a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>    ├── dotenv_example           &lt;-- example file for creating your optional .env file
<a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>    ├── main.py                  &lt;-- the primary python &quot;console application&quot;
<a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>    ├── pg.ps1                   &lt;-- script to run the psql program in an easy manner
<a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>    ├── requirements.in          &lt;-- the python required libraries list, used by venv.ps1
<a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>    ├── set-env-vars-sample.ps1  &lt;-- editable generated script used to set your environment variables
<a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>    ├── venv.ps1                 &lt;-- powershell script to create your python virthal environment
<a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>    ├── webapp.ps1               &lt;-- powershell script to start the web UI application
<a id="__codelineno-2-22" name="__codelineno-2-22" href="#__codelineno-2-22"></a>    ├── webapp.py                &lt;-- web app implementation python file
<a id="__codelineno-2-23" name="__codelineno-2-23" href="#__codelineno-2-23"></a>    ├── sql                      &lt;-- sql scripts, such as to delete/define the legal_cases table and indexes
<a id="__codelineno-2-24" name="__codelineno-2-24" href="#__codelineno-2-24"></a>    ├── src                      &lt;-- primary python source code directory
<a id="__codelineno-2-25" name="__codelineno-2-25" href="#__codelineno-2-25"></a>    ├── static                   &lt;-- static assets served by the web application
<a id="__codelineno-2-26" name="__codelineno-2-26" href="#__codelineno-2-26"></a>    ├── templates                &lt;-- jinja2 templates for dynamic content generation; queries, prompts
<a id="__codelineno-2-27" name="__codelineno-2-27" href="#__codelineno-2-27"></a>    ├── tests                    &lt;-- unit tests using the pytest testing framework
<a id="__codelineno-2-28" name="__codelineno-2-28" href="#__codelineno-2-28"></a>    ├── tmp                      &lt;-- not in GitHub; manually create this directory yourself
<a id="__codelineno-2-29" name="__codelineno-2-29" href="#__codelineno-2-29"></a>    ├── venv                     &lt;-- not in GitHub; this is the python virtual environment
<a id="__codelineno-2-30" name="__codelineno-2-30" href="#__codelineno-2-30"></a>    └── views                    &lt;-- web UI html views/pages
</code></pre></div>
<hr />
<h2 id="35-set-the-environment-variables-for-this-project">3.5 Set the Environment Variables for this project</h2>
<p>Per the <a href="https://12factor.net/config">Twelve-Factor App methodology</a>,
configuration is stored in environment variables.  </p>
<h3 id="351-list-of-enviroment-variables">3.5.1 List of enviroment variables</h3>
<p>This reference implementation uses the following environment variables.
They begin with the prefix <strong>AIG4PG_</strong>.</p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>AIG4PG_LLM_CONTEXT_MAX_NTOKENS</td>
<td>Optional.  Defaults to 0, no truncation.</td>
</tr>
<tr>
<td>AIG4PG_LOG_LEVEL</td>
<td>See values in class LoggingLevelService - notset, debug, info, warning, error, or critical</td>
</tr>
<tr>
<td>AIG4PG_OPENAI_COMPLETIONS_DEP</td>
<td>The name of your Azure OpenAI completions deployment</td>
</tr>
<tr>
<td>AIG4PG_OPENAI_EMBEDDINGS_DEP</td>
<td>The name of your Azure OpenAI embeddings deployment</td>
</tr>
<tr>
<td>AIG4PG_OPENAI_KEY</td>
<td>The Key of your Azure OpenAI account</td>
</tr>
<tr>
<td>AIG4PG_OPENAI_URL</td>
<td>The URL of your Azure OpenAI account</td>
</tr>
<tr>
<td>AIG4PG_PG_AGE_GRAPH_NAME</td>
<td>The name of the PostgreSQL AGE graph</td>
</tr>
<tr>
<td>AIG4PG_PG_FLEX_DB</td>
<td>Azure PostgreSQL Flex Server database</td>
</tr>
<tr>
<td>AIG4PG_PG_FLEX_PASS</td>
<td>Azure PostgreSQL Flex Server user password</td>
</tr>
<tr>
<td>AIG4PG_PG_FLEX_PORT</td>
<td>Azure PostgreSQL Flex Server port</td>
</tr>
<tr>
<td>AIG4PG_PG_FLEX_SERVER</td>
<td>Azure PostgreSQL Flex Server hostname</td>
</tr>
<tr>
<td>AIG4PG_PG_FLEX_USER</td>
<td>Azure PostgreSQL Flex Server user</td>
</tr>
<tr>
<td>LOCAL_PG_PASS</td>
<td>Optional.  Used by the psql.ps1/psql.sh scripts for local PostgreSQL access</td>
</tr>
</tbody>
</table>
<h3 id="352-setting-these-environment-variables">3.5.2 Setting these Environment Variables</h3>
<p>The repo contains generated PowerShell script <strong>set-env-vars-sample.ps1</strong>
which sets all of these AIG4PG_ environment values.
You may find it useful to edit and execute this script rather than set them manually on your system</p>
<h3 id="353-python-dotenv">3.5.3 python-dotenv</h3>
<p>The <a href="https://pypi.org/project/python-dotenv/">python-dotenv</a> library is used
in  this implementation.  It allows you to define environment variables in a
file named <strong><code>.env</code></strong> and thus can make it easier to use this project during local development.</p>
<p>Please see the <strong>dotenv_example</strong> files in each subapplication for examples.</p>
<p>It is important for you to have a <strong>.gitignore</strong> entry for the <strong>.env</strong> file
so that application secrets don't get leaked into your source control system.</p>
<hr />
<h2 id="36-clone-the-github-repo-and-create-the-python-virtual-environment">3.6 Clone the GitHub repo and create the Python Virtual Environment</h2>
<p>These are one-time tasks in the use of this project.</p>
<h3 id="361-clone-the-repo">3.6.1 Clone the Repo</h3>
<p>This will copy the code, scripts, and curated data files to your computer.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>&gt; cd some-parent-directory-on-your-computer
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>&gt; git clone https://github.com/cjoakim/aigraph4pg.git
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>&gt; cd AIGraph4pg    &lt;-- navigate into the project root directory
</code></pre></div>
<h3 id="362-create-the-python-virtual-environment">3.6.2 Create the Python Virtual Environment</h3>
<p>A Python Virtual Environment is an isolated location on your computer
containing a well-defined set of required libraries, defined in the 
<strong>requirements.in</strong> file.  The libraries are downloaded from <a href="https://pypi.org/">PyPi</a>.
The application code in this project then uses these Python libraries.</p>
<p>This is conceptually similar to NuGet (DotNet ecosystem), MavenCentral (Java ecocystem),
NPM (Node.js and JavaScript ecosystem), etc..</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>AIGraph4pg&gt; cd python       
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>python&gt;                   &lt;-- You&#39;ll primarily use this directory in this project
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>python&gt; .\venv.ps1
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>python&gt; pip list          &lt;-- pip is the library installer program; you&#39;ll see smilar output below
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>Package                              Version
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>------------------------------------ -----------
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>aenum                                3.1.15
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>agefreighter                         0.7.5
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>ageqrp                               0.1.0
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>     ... many lines omitted here ...
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>wsproto                              1.2.0
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>yarl                                 1.16.0
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>zipp                                 3.21.0
</code></pre></div>
<h3 id="363-activate-the-python-virtual-environment-venv">3.6.3 Activate the Python Virtual Environment (venv)</h3>
<p><strong>Each time</strong> you navigate to the python directory of this project
and want to execute a python program you will need to <strong>"activate"</strong> the
virtual environment, as shown below:</p>
<p>Notice how when the Virtual Environment is activated your shell
prompt changes to have the <strong>(venv)</strong> prefix.
This is a useful visual cue.</p>
<h3 id="364-windows-11-powershell">3.6.4 Windows 11 PowerShell</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>PS ...\python&gt;
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>PS ...\python&gt; .\venv\Scripts\Activate.ps1
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>(venv) PS ...\python&gt;
</code></pre></div>
<p>If you find this tedious to type often, you can optionally create an alias
in your <strong>Microsoft.PowerShell_profile.ps1</strong> file like the following.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>New-Alias va .\venv\Scripts\activate
</code></pre></div>
<p>With this alias, you simply have to type <strong>va</strong> (i.e - virtualenv activate)
instead of typing out ".\venv\Scripts\Activate.ps1".</p>
<p>See https://learn.microsoft.com/en-us/powershell/scripting/learn/shell/creating-profiles?view=powershell-7.5</p>
<h3 id="365-macos-bash-shell">3.6.5 macOS bash shell</h3>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>[~/AIGraph4pg]$ cd python
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>[~/AIGraph4pg/python]$ source venv/bin/activate
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>(venv) [~/AIGraph4pg/python]$
</code></pre></div>
<hr />
<h2 id="37-prepare-your-azure-postgresql-server">3.7 Prepare your Azure PostgreSQL Server</h2>
<p>In a <strong>Windows PowerShell</strong> window navigate to the python\ directory of this repo,
execute the following command to connect to the <strong>postgres</strong>
database in your Azure PostgreSQL server.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>.\pg.ps1 flex postgres
</code></pre></div>
<p>This will put you into a <strong>psql</strong> terminal, connected to your Azure PostgreSQL
server, per the several AIG4... environment variables you set above.
Alternatively, you can use a desktop UI such as <strong>pgAdmin4</strong> for these commands,
but the documentation here assumes psql.</p>
<p>Your terminal prompt should now look like this, indicating that you are connected
to the postgres database, and psql is awaiting a command.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>postgres=&gt;
</code></pre></div>
<p>Next, confirm the user, database, and host your psql terminal is connected to.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a>postgres=&gt; \conninfo
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>You are connected to database &quot;postgres&quot; as user &quot;chjoakim&quot; on host ...
</code></pre></div>
<p>You can see the list of users with the <strong>\du</strong> command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a>postgres=&gt; \du
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a>                                List of roles
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>   Role name    |                         Attributes
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a>----------------+------------------------------------------------------------
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a> azure_pg_admin | Cannot login
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a> azuresu        | Superuser, Create role, Create DB, Replication, Bypass RLS
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a> chjoakim       | Create role, Create DB, Bypass RLS
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a> replication    | Replication
</code></pre></div>
<p>You can create and alter additional database users with these commands.
In these examples, elsa is the user ID.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a>postgres=&gt; create role elsa with createdb login password &#39;&lt;secret&gt;&#39;;
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a>postgres=&gt; alter user elsa with password &#39;&lt;new-password&gt;&#39;;
</code></pre></div>
<p>Next, list the databases in the server.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a>postgres=&gt; SELECT datname FROM pg_catalog.pg_database;
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>      datname
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a>-------------------
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a> azure_maintenance
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a> template1
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a> postgres
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a> azure_sys
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a> template0
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a> dev
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>(6 rows)
</code></pre></div>
<p>If the <strong>dev</strong> database is not present, create it as shown here.
Replace chjoakim with your ID.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a>postgres=&gt; create database dev owner chjoakim;
</code></pre></div>
<h2 id="371-configure-the-dev-database">3.7.1 Configure the dev database</h2>
<p>First, switch to the dev database with this command.
Notice how the prompt changes to 'dev-&gt;'/</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a>postgres=&gt; \connect dev
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a>You are now connected to database &quot;dev&quot; as user ...
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>dev=&gt;
</code></pre></div>
<p>Enable the four PostgreSQL extensions that we'll use in this application
with the <strong>CREATE EXTENSION</strong> command.</p>
<p>If you created your Azure PostgreSQL server manually, rather than
with the az CLI script in this repo, you'll first have to enable
these extensions as shown in this screen shot:</p>
<p align="center">
  <img src="img/enable-extensions.png" width="70%">
</p>

<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a>dev=&gt; CREATE EXTENSION IF NOT EXISTS age CASCADE;
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>CREATE EXTENSION
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a>dev=&gt; CREATE EXTENSION IF NOT EXISTS vector CASCADE;
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>CREATE EXTENSION
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a>dev=&gt; CREATE EXTENSION IF NOT EXISTS PG_DISKANN CASCADE;
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>CREATE EXTENSION
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a>dev=&gt; CREATE EXTENSION IF NOT EXISTS AZURE_AI CASCADE;
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>CREATE EXTENSION
</code></pre></div>
<p>Verify that these extensions are created with this query.
You should see similar output.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a>dev=&gt; SELECT oid, extname FROM pg_extension order by extname;
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a>  oid  |  extname
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a>-------+------------
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a> 25081 | age
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a> 25687 | azure_ai
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a> 25668 | pg_diskann
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a> 14258 | plpgsql
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a> 24760 | vector
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>(5 rows)
</code></pre></div>
<p>This is a similar query:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a>dev=&gt; show azure.extensions;
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a>        azure.extensions
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a>--------------------------------
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a> AGE,VECTOR,PG_DISKANN,AZURE_AI
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>(1 row)
</code></pre></div>
<h2 id="372-configure-the-dev-database-for-apache-age-graphs">3.7.2 Configure the dev database for Apache AGE graphs</h2>
<p>To make AGE functionality easier to use for a given user,
you can set their default <strong>search_path</strong> as shown below.
Replace chjoakim with your ID.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a>dev=&gt; alter user chjoakim set search_path=&#39;public&#39;,&#39;ag_catalog&#39;,&quot;$user&quot;;
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>ALTER ROLE
</code></pre></div>
<p>You can list the AGE graphs with this query.
It should initially return zero rows.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a>dev=&gt; SELECT * FROM ag_catalog.ag_graph;
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a> graphid | name | namespace
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>---------+------+-----------
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a>(0 rows)
</code></pre></div>
<p>Create the Apache AGE <strong>legal_cases</strong> graph, enter this command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>dev=&gt; SELECT ag_catalog.create_graph(&#39;legal_cases&#39;);
</code></pre></div>
<p>List the AGE graphs again, and legal_cases should be in the list.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a>dev=&gt; SELECT * FROM ag_catalog.ag_graph;
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a> graphid |    name     |  namespace
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>---------+-------------+-------------
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a>   25768 | legal_cases | legal_cases
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>(1 row)
</code></pre></div>
<p>This graph can be dropped at a later date with this command,
but don't do this now.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a>dev=&gt; SELECT * FROM ag_catalog.drop_graph(&#39;legal_cases&#39;, true);
</code></pre></div>
<p>You can quit and close the psql program with the <strong>\q</strong> command.
Notice how it puts you back into the original python\ directory
and the virtual environment is activated as indicated with the (venv)
prompt prefix.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a>dev=&gt; \q
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>(venv) PS ...\python&gt;
</code></pre></div>
<hr />
<h2 id="38-load-azure-postgresql-with-the-python-libraries-dataset">3.8 Load Azure PostgreSQL with the Python Libraries Dataset</h2>
<p>The dataset is a curated set of information on 10,000+ <strong>Python Libraries</strong>
from web crawling and other tools.  This dataset provides a foundation to
demonstrate both <strong>traditional graph</strong> as well as <strong>vector search</strong>
capabilities in Azure PostgreSQL.</p>
<p>The Python libraries have both dependencies and authors, and this graph
can be traversed.  Likewise, Python library data has rich text fields
(descriptions, keywords) that showcase vector search.</p>
<p>It is hoped that this dataset is relatable to an IT audience, particularly
application developers, and data scientists.</p>
<h3 id="381-mainpy">3.8.1 main.py</h3>
<p>This is the Python program (i.e. - <em>.py suffix) that implements the
</em><em>"console app"</em><em> in this project.  You can see its </em><em>help content</em>*
by executing the following command.  You should see similar output
though some lines have been omitted in this documentation.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>(venv) PS ...\python&gt; python main.py help
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>...
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>Usage:
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>    python main.py log_defined_env_vars
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>    python main.py list_pg_extensions_and_settings
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>    python main.py delete_define_legal_cases_table
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>    python main.py query_legal_cases_table
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>    python main.py relational_search_case_id 594079
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>    python main.py load_age_graph_with_agefreighter &lt;graph-naame&gt; &lt;do-load-bool&gt;
<a id="__codelineno-25-10" name="__codelineno-25-10" href="#__codelineno-25-10"></a>    python main.py load_age_graph_with_agefreighter legal_cases_af1 true
<a id="__codelineno-25-11" name="__codelineno-25-11" href="#__codelineno-25-11"></a>    python main.py execute_graph_validation_queries legal_cases_af1
<a id="__codelineno-25-12" name="__codelineno-25-12" href="#__codelineno-25-12"></a>    python main.py vector_search_similar_cases 594079 10
<a id="__codelineno-25-13" name="__codelineno-25-13" href="#__codelineno-25-13"></a>    python main.py vector_search_words word1 word2 word3 etc
<a id="__codelineno-25-14" name="__codelineno-25-14" href="#__codelineno-25-14"></a>    python main.py vector_search_words Woolworth Co. v. City of Seattle
</code></pre></div>
<p>Display the several <strong>AIG4... environment variables</strong> with this command.
Visually validate that they are correct (i.e. - pointing to your
Azure PostgreSQL server, your Azure OpenAI service, etc.).</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a>(venv) PS ...\python&gt; python main.py log_defined_env_vars
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a>... output not shown here ...
</code></pre></div>
<p>Edit and execute the <strong>set-env-vars-sample.ps1</strong> script if the 
environment variables have no values, or incorrect values.</p>
<h3 id="382-mainpy-delete_define_libraries_table">3.8.2 main.py - delete_define_libraries_table</h3>
<p>Delete and recreate (i.e. 'delete-define') the legal_cases relational table
with the following command.  It uses file <strong>python/sql/legal_cases_ddl.sql</strong>
in the repo.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>python&gt; python .\main.py delete_define_legal_cases_table
</code></pre></div>
<p>In <strong>psql</strong> you can verify that the table and related indexes 
were created with the <strong>\d</strong> command.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a>dev=&gt; \d legal_cases
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>                                          Table &quot;public.legal_cases&quot;
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>      Column       |          Type           | Collation | Nullable |                 Default
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a>-------------------+-------------------------+-----------+----------+-----------------------------------------
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a> id                | bigint                  |           | not null | nextval(&#39;legal_cases_id_seq&#39;::regclass)
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a> name              | character varying(1024) |           |          |
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a> name_abbreviation | character varying(1024) |           |          |
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a> case_url          | character varying(1024) |           |          |
<a id="__codelineno-28-9" name="__codelineno-28-9" href="#__codelineno-28-9"></a> decision_date     | date                    |           |          |
<a id="__codelineno-28-10" name="__codelineno-28-10" href="#__codelineno-28-10"></a> court_name        | character varying(1024) |           |          |
<a id="__codelineno-28-11" name="__codelineno-28-11" href="#__codelineno-28-11"></a> citation_count    | integer                 |           |          |
<a id="__codelineno-28-12" name="__codelineno-28-12" href="#__codelineno-28-12"></a> text_data         | text                    |           |          |
<a id="__codelineno-28-13" name="__codelineno-28-13" href="#__codelineno-28-13"></a> json_data         | jsonb                   |           |          |
<a id="__codelineno-28-14" name="__codelineno-28-14" href="#__codelineno-28-14"></a> embedding         | vector(1536)            |           |          |
<a id="__codelineno-28-15" name="__codelineno-28-15" href="#__codelineno-28-15"></a>Indexes:
<a id="__codelineno-28-16" name="__codelineno-28-16" href="#__codelineno-28-16"></a>    &quot;legal_cases_pkey&quot; PRIMARY KEY, btree (id)
<a id="__codelineno-28-17" name="__codelineno-28-17" href="#__codelineno-28-17"></a>    &quot;idx_legal_cases_citation_count&quot; btree (citation_count)
<a id="__codelineno-28-18" name="__codelineno-28-18" href="#__codelineno-28-18"></a>    &quot;idx_legal_cases_court_name&quot; btree (court_name)
<a id="__codelineno-28-19" name="__codelineno-28-19" href="#__codelineno-28-19"></a>    &quot;idx_legal_cases_decision_date&quot; btree (decision_date)
<a id="__codelineno-28-20" name="__codelineno-28-20" href="#__codelineno-28-20"></a>    &quot;idx_legal_cases_diskann_embedding&quot; diskann (embedding vector_cosine_ops)
<a id="__codelineno-28-21" name="__codelineno-28-21" href="#__codelineno-28-21"></a>    &quot;idx_legal_cases_json_data_gin&quot; gin (json_data)
<a id="__codelineno-28-22" name="__codelineno-28-22" href="#__codelineno-28-22"></a>    &quot;idx_legal_cases_name_abbreviation&quot; btree (name_abbreviation)
</code></pre></div>
<h3 id="383-psql-copy-into-the-legal_cases-table">3.8.3 psql copy into the legal_cases table</h3>
<p>The COPY protocol is very fast and efficient in PostgreSQL.
We use it here to load the curated dataset in the repo.</p>
<p>Since this curated dataset is large, it is stored in the GitHub
repo as a zip file: <strong>data/legal_cases/legal_cases.zip</strong>.</p>
<p>One way to do this is with <strong>Windows Explorer</strong>, select the zip file,
right mouse, then Extract All... 
Alternatively, if you have Java installed, you can use the jar command.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a>PS ...\legal_cases&gt; jar tvf .\legal_cases.zip
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a>155009537 Mon Dec 09 10:48:22 EST 2024 legal_cases.sql
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a>PS ...\legal_cases&gt; jar xvf .\legal_cases.zip
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a> inflated: legal_cases.sql
</code></pre></div>
<p>The unzipped file is <strong>legal_cases.sql</strong>, which is used in the following
COPY command in <strong>psql</strong>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a>dev=&gt; \copy legal_cases FROM &#39;&lt;fully-qualiied-filename&gt;&#39; DELIMITER E&#39;\t&#39;
</code></pre></div>
<p>Your fully-qualiied-filename might look like the following.
This output indicates that 2679 rows were loaded into the table.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a>dev=&gt; \copy legal_cases FROM C:\Users\chjoakim\github\AIGraph4pg\data\legal_cases\legal_cases.sql DELIMITER E&#39;\t&#39;
<a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a>COPY 2679
</code></pre></div>
<p>Execute this query in psql to confirm that the table does indeed contain 2679 rows.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a>dev=&gt; select count(*) from legal_cases;
<a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a> count
<a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a>-------
<a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a>  2679
<a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a>(1 row)
</code></pre></div>
<h3 id="385-load-the-legal_cases-age-graph">3.8.5 Load the legal_cases AGE graph</h3>
<p>This process is executed with python, rather than psql, with the
following command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a>(venv) PS ...\python&gt; python main.py load_age_graph_with_agefreighter legal_cases true
<a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a>2025-02-10 17:22:22,035 - Running on Windows, setting WindowsSelectorEventLoopPolicy
<a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a>2025-02-10 17:22:22,036 - DBService#initialze_pool creating new...
<a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a>...
<a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a>2025-02-10 17:22:22,439 - AGEGraphLoader#load_legal_cases_dataset: legal_cases True
<a id="__codelineno-33-6" name="__codelineno-33-6" href="#__codelineno-33-6"></a>2025-02-10 17:22:22,440 - freighter: &lt;agefreighter.multicsvfreighter.MultiCSVFreighter object at 0x0000021B15073B60&gt;
<a id="__codelineno-33-7" name="__codelineno-33-7" href="#__codelineno-33-7"></a>2025-02-10 17:22:22,906 - freighter connected: &lt;agefreighter.multicsvfreighter.MultiCSVFreighter object at 0x0000021B15073B60&gt;
<a id="__codelineno-33-8" name="__codelineno-33-8" href="#__codelineno-33-8"></a>2025-02-10 17:22:25,358 - freighter loaded
<a id="__codelineno-33-9" name="__codelineno-33-9" href="#__codelineno-33-9"></a>2025-02-10 17:22:25,358 - closing freighter...
<a id="__codelineno-33-10" name="__codelineno-33-10" href="#__codelineno-33-10"></a>2025-02-10 17:22:25,358 - closed
<a id="__codelineno-33-11" name="__codelineno-33-11" href="#__codelineno-33-11"></a>2025-02-10 17:22:25,359 - AGEGraphLoader#execute_validation_queries: legal_cases
<a id="__codelineno-33-12" name="__codelineno-33-12" href="#__codelineno-33-12"></a>2025-02-10 17:22:25,359 - DBService#execute_query, stmt: select graphid, name, namespace from ag_catalog.ag_graph order by graphid;
<a id="__codelineno-33-13" name="__codelineno-33-13" href="#__codelineno-33-13"></a>[33990, &#39;legal_cases&#39;, &#39;legal_cases&#39;]
<a id="__codelineno-33-14" name="__codelineno-33-14" href="#__codelineno-33-14"></a>2025-02-10 17:22:25,460 - DBService#execute_query, stmt: select * from ag_catalog.cypher(&#39;legal_cases&#39;, $$ MATCH (n) RETURN count(n) as count $$) as (v agtype);
<a id="__codelineno-33-15" name="__codelineno-33-15" href="#__codelineno-33-15"></a>2679
<a id="__codelineno-33-16" name="__codelineno-33-16" href="#__codelineno-33-16"></a>2025-02-10 17:22:25,565 - DBService#execute_query, stmt: select * from ag_catalog.cypher(&#39;legal_cases&#39;, $$ MATCH ()-[r]-&gt;() RETURN count(r) as count $$) as (e agtype);
<a id="__codelineno-33-17" name="__codelineno-33-17" href="#__codelineno-33-17"></a>15998
<a id="__codelineno-33-18" name="__codelineno-33-18" href="#__codelineno-33-18"></a>2025-02-10 17:22:25,684 - DBService#execute_query, stmt: select * from ag_catalog.cypher(&#39;legal_cases&#39;, $$ MATCH (c) RETURN c limit 3 $$) as (v agtype);
<a id="__codelineno-33-19" name="__codelineno-33-19" href="#__codelineno-33-19"></a>{&#39;id&#39;: 844424930131969, &#39;label&#39;: &#39;Case&#39;, &#39;properties&#39;: {&#39;id&#39;: &#39;1017660&#39;, &#39;name&#39;: &#39;United Mutual Savings Bank v. Riebli&#39;, &#39;court&#39;: &#39;Washington Supreme Court&#39;, &#39;case_url&#39;: &#39;https://static.case.law/wash-2d/55/cases/0816-01.json&#39;, &#39;decision_year&#39;: &#39;1960&#39;, &#39;citation_count&#39;: &#39;14&#39;}}
<a id="__codelineno-33-20" name="__codelineno-33-20" href="#__codelineno-33-20"></a>{&#39;id&#39;: 844424930131970, &#39;label&#39;: &#39;Case&#39;, &#39;properties&#39;: {&#39;id&#39;: &#39;594079&#39;, &#39;name&#39;: &#39;Martindale Clothing Co. v. Spokane &amp; Eastern Trust Co.&#39;, &#39;court&#39;: &#39;Washington Supreme Court&#39;, &#39;case_url&#39;: &#39;https://static.case.law/wash/79/cases/0643-01.json&#39;, &#39;decision_year&#39;: &#39;1914&#39;, &#39;citation_count&#39;: &#39;5&#39;}}
<a id="__codelineno-33-21" name="__codelineno-33-21" href="#__codelineno-33-21"></a>{&#39;id&#39;: 844424930131971, &#39;label&#39;: &#39;Case&#39;, &#39;properties&#39;: {&#39;id&#39;: &#39;552848&#39;, &#39;name&#39;: &#39;Lynch v. Ninemire Packing Co.&#39;, &#39;court&#39;: &#39;Washington Supreme Court&#39;, &#39;case_url&#39;: &#39;https://static.case.law/wash/63/cases/0423-01.json&#39;, &#39;decision_year&#39;: &#39;1911&#39;, &#39;citation_count&#39;: &#39;7&#39;}}
<a id="__codelineno-33-22" name="__codelineno-33-22" href="#__codelineno-33-22"></a>2025-02-10 17:22:25,794 - DBService#execute_query, stmt: select * from ag_catalog.cypher(&#39;legal_cases&#39;, $$ MATCH ()-[r]-() RETURN r limit 3 $$) as (r agtype);
<a id="__codelineno-33-23" name="__codelineno-33-23" href="#__codelineno-33-23"></a>{&#39;id&#39;: 1125899906842625, &#39;label&#39;: &#39;cites&#39;, &#39;end_id&#39;: 844424930131970, &#39;start_id&#39;: 844424930131969, &#39;properties&#39;: {&#39;case_id&#39;: &#39;1017660&#39;, &#39;other_id&#39;: &#39;594079&#39;, &#39;case_name&#39;: &#39;United Mutual Savings Bank v. Riebli&#39;, &#39;case_year&#39;: &#39;1960&#39;, &#39;other_name&#39;: &#39;Martindale Clothing Co. v. Spokane &amp; Eastern Trust Co.&#39;, &#39;other_year&#39;: &#39;1914&#39;}}
<a id="__codelineno-33-24" name="__codelineno-33-24" href="#__codelineno-33-24"></a>{&#39;id&#39;: 1407374883553281, &#39;label&#39;: &#39;cited_by&#39;, &#39;end_id&#39;: 844424930131969, &#39;start_id&#39;: 844424930131970, &#39;properties&#39;: {&#39;case_id&#39;: &#39;594079&#39;, &#39;other_id&#39;: &#39;1017660&#39;, &#39;case_name&#39;: &#39;Martindale Clothing Co. v. Spokane &amp; Eastern Trust Co.&#39;, &#39;case_year&#39;: &#39;1914&#39;, &#39;other_name&#39;: &#39;United Mutual Savings Bank v. Riebli&#39;, &#39;other_year&#39;: &#39;1960&#39;}}
<a id="__codelineno-33-25" name="__codelineno-33-25" href="#__codelineno-33-25"></a>{&#39;id&#39;: 1125899906842626, &#39;label&#39;: &#39;cites&#39;, &#39;end_id&#39;: 844424930131971, &#39;start_id&#39;: 844424930131969, &#39;properties&#39;: {&#39;case_id&#39;: &#39;1017660&#39;, &#39;other_id&#39;: &#39;552848&#39;, &#39;case_name&#39;: &#39;United Mutual Savings Bank v. Riebli&#39;, &#39;case_year&#39;: &#39;1960&#39;, &#39;other_name&#39;: &#39;Lynch v. Ninemire Packing Co.&#39;, &#39;other_year&#39;: &#39;1911&#39;}}
<a id="__codelineno-33-26" name="__codelineno-33-26" href="#__codelineno-33-26"></a>2025-02-10 17:22:25,907 - DBService#close_pool, closing...
<a id="__codelineno-33-27" name="__codelineno-33-27" href="#__codelineno-33-27"></a>2025-02-10 17:22:25,908 - DBService#close_pool, closed
</code></pre></div>
<p>This output shows that <strong>2679 vertices and 15998 edges</strong> were loaded into the graph.</p>
<p>The output also contains several validation queries which display several
vertices and edges in the AGE graph.</p>
<p>This Apache AGE graph loading functionality is implemented here with the
<a href="https://pypi.org/project/agefreighter/">agefreighter</a> python library.
Notice how the above loading of 2679 vertices and 15998 edges only took
<strong>2.919 seconds</strong> from a laptop and home network (pertinent log lines shown below).</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a>2025-02-10 17:22:22,439 - AGEGraphLoader#load_legal_cases_dataset: legal_cases True
<a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a>2025-02-10 17:22:22,440 - freighter: &lt;agefreighter.multicsvfreighter.MultiCSVFreighter object at 0x0000021B15073B60&gt;
<a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a>2025-02-10 17:22:22,906 - freighter connected: &lt;agefreighter.multicsvfreighter.MultiCSVFreighter object at 0x0000021B15073B60&gt;
<a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a>2025-02-10 17:22:25,358 - freighter loaded
</code></pre></div>
<hr />
<h2 id="39-run-the-web-application-on-your-computer">3.9 Run the Web Application on your computer</h2>
<p>Now that you've loaded both the relational and Apache AGE graph data
into your Azure PostgreSQL server, you can access it with a web application
which provides a User Interface (UI).</p>
<p>The web application is intended to run locally, but you may wish to 
deploy it to Azure, such as to Azure Container Apps (ACA).
This deployment process is easy, but is out-of-scope for this 
tutorial and reference application.  You can read more about 
Azure Container Apps here: https://learn.microsoft.com/en-us/azure/container-apps/ </p>
<h3 id="391-run-as-a-python-process">3.9.1 Run as a Python process</h3>
<p>Simply run the <strong>webapp.ps1</strong> script in the \python directory as shown below:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a>(venv) PS ...\python&gt; .\webapp.ps1
<a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a>activating the venv ...
<a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a>Python 3.12.9
<a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a>2025-02-10 09:35:41,406 - Windows platform detected, setting WindowsSelectorEventLoopPolicy
<a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a>2025-02-10 09:35:41,407 - webapp.py started
<a id="__codelineno-35-6" name="__codelineno-35-6" href="#__codelineno-35-6"></a>2025-02-10 09:35:43,920 - Windows platform detected, setting WindowsSelectorEventLoopPolicy
<a id="__codelineno-35-7" name="__codelineno-35-7" href="#__codelineno-35-7"></a>2025-02-10 09:35:43,921 - webapp.py started
<a id="__codelineno-35-8" name="__codelineno-35-8" href="#__codelineno-35-8"></a>2025-02-10 09:35:43,926 - log_defined_env_vars: {
<a id="__codelineno-35-9" name="__codelineno-35-9" href="#__codelineno-35-9"></a>  &quot;AIG4PG_LLM_CONTEXT_MAX_NTOKENS&quot;: &quot;10000&quot;,
<a id="__codelineno-35-10" name="__codelineno-35-10" href="#__codelineno-35-10"></a>  &quot;AIG4PG_LOG_LEVEL&quot;: &quot;info&quot;,
<a id="__codelineno-35-11" name="__codelineno-35-11" href="#__codelineno-35-11"></a>
<a id="__codelineno-35-12" name="__codelineno-35-12" href="#__codelineno-35-12"></a>...
<a id="__codelineno-35-13" name="__codelineno-35-13" href="#__codelineno-35-13"></a>
<a id="__codelineno-35-14" name="__codelineno-35-14" href="#__codelineno-35-14"></a>2025-02-10 09:35:44,301 - DBService#initialze_pool, pool opened
<a id="__codelineno-35-15" name="__codelineno-35-15" href="#__codelineno-35-15"></a>[2025-02-10 09:35:44 -0500] [6880] [INFO] Running on http://127.0.0.1:8000 (CTRL + C to quit)
<a id="__codelineno-35-16" name="__codelineno-35-16" href="#__codelineno-35-16"></a>2025-02-10 09:35:44,752 - Running on http://127.0.0.1:8000 (CTRL + C to quit)
</code></pre></div>
<p>You should see logging output similar to the above.</p>
<p>Visit <strong>http://127.0.0.1:8000</strong> with your browser.  You should then see the
home page of the UI</p>
<h3 id="392-run-as-a-docker-container">3.9.2 Run as a Docker container</h3>
<p>This UI application can also be executed as a Docker container
on your desktop with <strong>docker compose</strong>.
See the <a href="https://docs.docker.com/compose/">Docker Compose</a> docs for more info.</p>
<p>See the <strong>python/docker-compose.yml</strong> file, and edit it as necessary.
Docker Compose works with environment variables, which are passed in from
your computer into the running container.</p>
<p>In one PowerShell tab in the \python directory, enter this command:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a>(venv) PS ...\python&gt; 
<a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a>docker compose -f docker-compose.yml up
</code></pre></div>
<p>This will download and execute the <strong>cjoakim/aigraph4pg:latest</strong>
image that is hosted at Docker Hub.</p>
<p>Open to your web browser to URL <strong>http://127.0.0.1:8000</strong> or <strong>http://localhost:8000</strong>
to see the home page of the applicaton, which looks like this:</p>
<p align="center">
  <img src="img/ui-home-page.png" width="90%">
</p>

<p>In another PowerShell tab, also in the \python directory, enter this command
when you want to stop the application.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a>(venv) PS ...\python&gt; 
<a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a>docker compose -f docker-compose.yml down
</code></pre></div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        &#169; Microsoft 2025
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.expand", "navigation.sections", "toc.integrate", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
    
  </body>
</html>